<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>基于深度学习预测 CRISPR guide RNA 的切割效率 • Intro2DNN</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="基于深度学习预测 CRISPR guide RNA 的切割效率">
<meta property="og:description" content="Intro2DNN">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Intro2DNN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cnn.html">Introduction to image recognition with deep learning</a>
    </li>
    <li>
      <a href="../articles/cnn_zh.html">物体识别入门</a>
    </li>
    <li>
      <a href="../articles/lstm.html">Prediction of CRISPR guide RNA activity with deep learning</a>
    </li>
    <li>
      <a href="../articles/lstm_ja.html">深層学習を利用した CRISPR guide RNA の活性予測</a>
    </li>
    <li>
      <a href="../articles/lstm_zh.html">基于深度学习预测 CRISPR guide RNA 的切割效率</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jsun/Intro2DNN">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lstm_zh_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>基于深度学习预测 CRISPR guide RNA 的切割效率</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jsun/Intro2DNN/blob/master/vignettes/lstm_zh.Rmd"><code>vignettes/lstm_zh.Rmd</code></a></small>
      <div class="hidden name"><code>lstm_zh.Rmd</code></div>

    </div>

    
    
<div id="摘要" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%91%98%E8%A6%81" class="anchor"></a>摘要</h2>
<p>深度学习在计算机视觉以及自然言语处理等诸多领域取得重大成果，其技术现已被应用在包括生命科学在内的其它领域。深度学习主要通过构建深度神经网络来解决传统机器学习算法难以解决的问题。在诸多种深度学习的网络结构中，卷积神经网络（Convolutional neural network; CNN）以及循环神经网络（Recurrent neural network; RNN）最为人们熟知。其中，卷积神经网络在目标识别及目标检测等计算机视觉领域表现出色；循环神经网络则是在时间序列数据处理以及自然言语处理方面表现出色。在本次研习会上，我们考虑到众多 Bioconductor 用户熟悉于基因组序列分析，因此我们将讲解循环神经网络的基本算法以及如何使用 R 构建循环神经网络的方法。</p>
<div id="课程目标" class="section level3">
<h3 class="hasAnchor">
<a href="#%E8%AF%BE%E7%A8%8B%E7%9B%AE%E6%A0%87" class="anchor"></a>课程目标</h3>
<p>在本次研习会上，我们将通过开发一个预测 CRISPR guide RNA 切割效率的深度学习模型来学习 RNN 和以其相似的一个叫做长短时记忆网络（Long short-term memory; LSTM）的算法。通过本次研习会，大家可以初步了解到以下内容。</p>
<ul>
<li>神经网络的基本概念</li>
<li>RNN (LSTM) 的基本概念</li>
<li>使用 R 构建深度学习模型的方法</li>
</ul>
</div>
<div id="课前准备" class="section level3">
<h3 class="hasAnchor">
<a href="#%E8%AF%BE%E5%89%8D%E5%87%86%E5%A4%87" class="anchor"></a>课前准备</h3>
<p>参加本次研习会需掌握以下知识点。</p>
<ul>
<li>R 语言的基础语法（安装 R 包、保存与读取数据文件、<code>for</code> 句、定义函数等）。</li>
<li>数学的基础知识（多元函数、线性组合、微分等）。</li>
</ul>
<p>由于本次研习会重点讲解深度学习的基本知识，我们不推荐已经熟悉深度学习算法或能够使用 Python 等其他编程语言搭建模型的人员参加。</p>
</div>
</div>
<div id="初始配置" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE" class="anchor"></a>初始配置</h2>
<p>在本次研习会上，我们主要使用 Torch <span class="citation">(PBC 2021)</span> 以及 coro <span class="citation">(Henry 2021)</span> 进行深度学习，并使用 tidyverse 进行可视化。</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'tidyverse'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'coro'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'torch'</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://torch.mlverse.org/docs">'torch'</a></span><span class="op">)</span>
<span class="fu"><a href="https://torch.mlverse.org/docs/reference/install_torch.html">install_torch</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">1200</span><span class="op">)</span></code></pre></div>
<p>重启 R，然后将 R 包加载。</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">'tidyverse'</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.1.5     ✔ dplyr   1.0.7</span>
<span class="co">#&gt; ✔ tidyr   1.1.4     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   2.0.2     ✔ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/r-lib/coro">'coro'</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'coro'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     collect</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://torch.mlverse.org/docs">'torch'</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="数据整合" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%95%B0%E6%8D%AE%E6%95%B4%E5%90%88" class="anchor"></a>数据整合</h2>
<div id="读取数据" class="section level3">
<h3 class="hasAnchor">
<a href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE" class="anchor"></a>读取数据</h3>
<p>本次研习会中使用的数据集可以从 <span class="citation">Wang D (2019)</span> 等人的论文的补充文件中下载。由于时间有限，我们将使用已经整理好的数据。该数据储存在研习会 Intro2DNN 包里，另外还可以从 <a href="https://github.com/jsun/Intro2DNN">GitHub</a> 下载。该数据包含 <em>train.tsv</em> 和 <em>valid.tsv</em> 文件，它们分别是训练集以及验证集。在这里，我们首先举个处理训练集 <em>train.tsv</em> 的例子。</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'train.tsv'</span>, package <span class="op">=</span> <span class="st">'Intro2DNN'</span><span class="op">)</span>
<span class="va">crisprcas9_train_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">train_fpath</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">crisprcas9_train_dataset</span><span class="op">)</span>
<span class="co">#&gt;          V1                    V2</span>
<span class="co">#&gt; 1 0.6989796 GAACCCGACTATGTTCGCCTG</span>
<span class="co">#&gt; 2 0.8012376 GATACTTACTCATAAGTCAGG</span>
<span class="co">#&gt; 3 0.9363944 AAGTCATCACAGTAATACCCG</span>
<span class="co">#&gt; 4 0.8221612 GAACATACTCTACTTAGCAAG</span>
<span class="co">#&gt; 5 0.2443082 GCTGTGCACGAGAATCTAGCA</span>
<span class="co">#&gt; 6 0.4637551 GGTGCCACTGTCCCTCAAGGT</span></code></pre></div>
<p>如上所示，<em>train.tsv</em> 由两列组成。第一列是 guide RNA 的切割效率，第二列是 guide RNA 序列的 21 个碱基。</p>
</div>
<div id="数据预处理" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86" class="anchor"></a>数据预处理</h3>
<p>为了方便操作，我们把 <em>train.csv</em> 中的切割效率作为标签（因变量）储存至 <code>y_train</code> 变量中，把 guide RNA 序列作为特征（自变量）储存至 <code>x_train</code> 变量中。</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x_train</span> <span class="op">&lt;-</span> <span class="va">crisprcas9_train_dataset</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">crisprcas9_train_dataset</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></code></pre></div>
<p>由于包括 Torch 包在内的大多数机器学习包都需要输入数值来做运算，因此我们有必要将字符串（即 guide RNA 序列）转换为数值。在这里，我们将使用 <code>chartr</code> 以及 <code>strsplit</code> 函数把 A、T、C、G 分别转换为整数 1、2、3、4。首先，我们先来对 <code>x_train</code> 变量中第一个元素来进行转换处理，确认其转换效应。</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">'ATCG'</span>, <span class="st">'1234'</span>, <span class="va">x_train</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "411333413212422343324"</span>
<span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">'ATCG'</span>, <span class="st">'1234'</span>, <span class="va">x_train</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [1] 4 1 1 3 3 3 4 1 3 2 1 2 4 2 2 3 4 3 3 2 4</span></code></pre></div>
<p>如上所示，我们可以看到我们成功地将 guide RNA 序列的 21 个碱基转换成了 21 个整数。这 21 个整数将代替碱基被视为 guide RNA 序列的特征。</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">'ATCG'</span>, <span class="st">'1234'</span>, <span class="va">x_train</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                  ncol <span class="op">=</span> <span class="fl">21</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">x_train</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="co">#&gt; [1,]    4    1    1    3    3    3    4    1    3     2     1     2     4     2</span>
<span class="co">#&gt; [2,]    4    1    2    1    3    2    2    1    3     2     3     1     2     1</span>
<span class="co">#&gt; [3,]    1    1    4    2    3    1    2    3    1     3     1     4     2     1</span>
<span class="co">#&gt; [4,]    4    1    1    3    1    2    1    3    2     3     2     1     3     2</span>
<span class="co">#&gt; [5,]    4    3    2    4    2    4    3    1    3     4     1     4     1     1</span>
<span class="co">#&gt; [6,]    4    4    2    4    3    3    1    3    2     4     2     3     3     3</span>
<span class="co">#&gt;      [,15] [,16] [,17] [,18] [,19] [,20] [,21]</span>
<span class="co">#&gt; [1,]     2     3     4     3     3     2     4</span>
<span class="co">#&gt; [2,]     1     4     2     3     1     4     4</span>
<span class="co">#&gt; [3,]     1     2     1     3     3     3     4</span>
<span class="co">#&gt; [4,]     2     1     4     3     1     1     4</span>
<span class="co">#&gt; [5,]     2     3     2     1     4     3     1</span>
<span class="co">#&gt; [6,]     2     3     1     1     4     4     2</span></code></pre></div>
<p>通过上述步骤，我们成功地将训练集从文件加载到 R 变量中，并将字符串转换成数值。下一步我们还要进一步的处理这个 R 变量。由于 Torch 包不能直接处理矩阵型的 R 变量，我们还需要按照 Torch 的规定来创建一个类（class, 即数据集和函数的集合）。</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">set_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/dataset.html">dataset</a></span><span class="op">(</span>
    <span class="st">'guidRNA_dataset'</span>,
    
    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">self</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span>
        <span class="va">self</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span>
    <span class="op">}</span>,
    
    .getitem <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">x_tensor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html">torch_tensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
        <span class="va">y_tensor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html">torch_tensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_tensor</span>, y <span class="op">=</span> <span class="va">y_tensor</span><span class="op">)</span>
    <span class="op">}</span>,
    
    .length <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<p>定义完 <code>set_dataset</code> 之后，我们将我们所准备的 <code>x_train</code> 以及 <code>y_train</code> 变量赋予给 <code>set_dataset</code>。然后我们在把 <code>set_dataset</code> 生成的变量代入至 <code>dataloader</code> 类以便在训练模型的时候可以有效的管理数据。</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset_train</span> <span class="op">&lt;-</span> <span class="fu">set_dataset</span><span class="op">(</span><span class="va">x_train</span>, <span class="va">y_train</span><span class="op">)</span>
<span class="va">dataloader_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/dataloader.html">dataloader</a></span><span class="op">(</span><span class="va">dataset_train</span>, batch_size <span class="op">=</span> <span class="fl">1024</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="模型构建" class="section level2">
<h2 class="hasAnchor">
<a href="#%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA" class="anchor"></a>模型构建</h2>
<div id="框架设计" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1" class="anchor"></a>框架设计</h3>
<p>使用 Torch 创建深度学习模型时，须按照 Torch 的规定，先设计一个神经网络的框架模版，然后利用其模版生成一个模型实例。在这里我们使用 Torch 来设计一个比较简单的深度学习框架用于预测 guide RNA 的切割效率。其框架主要由三组组件构成。第一个组件是由一层嵌入层构成，它接收 21 个整数（即 guide RNA 的特征量）并将其转换成 64 个实数值。第二个组件是由一层 LSTM 层构成，它接收由嵌入层传来的 64 个实数值，然后从其中提取 256 个特征值。第三个组件是由三层全连接层构成，他接收由 LSTM 传来的 256 个特征值并通过三层神经网络的运算将其转换成 1 个实数值。该实数值可被视为 guide RNA 的切割效率。</p>
<p>设计框架模版时，按照 Torch 的规定，我们需要创建一个含有 <code>initialize</code> 和 <code>forward</code> 函数的类。<code>initialize</code> 函数主要用于生成框架的每个组件。<code>forward</code> 函数主要用于定义数据的传输顺序，即每个组件的连接顺序。</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GenomicNet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_module.html">nn_module</a></span><span class="op">(</span>
    <span class="st">"GenomicNet"</span>,
  
    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">self</span><span class="op">$</span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_embedding.html">nn_embedding</a></span><span class="op">(</span>num_embeddings <span class="op">=</span> <span class="fl">4</span>, embedding_dim <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>
        <span class="va">self</span><span class="op">$</span><span class="va">lstm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_lstm.html">nn_lstm</a></span><span class="op">(</span>input_size <span class="op">=</span> <span class="fl">64</span>, hidden_size <span class="op">=</span> <span class="fl">256</span>, batch_first <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
        <span class="va">self</span><span class="op">$</span><span class="va">dropout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_dropout.html">nn_dropout</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
        <span class="va">self</span><span class="op">$</span><span class="va">fc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_linear.html">nn_linear</a></span><span class="op">(</span>in_features <span class="op">=</span> <span class="fl">256</span>, out_features <span class="op">=</span> <span class="fl">512</span><span class="op">)</span>
        <span class="va">self</span><span class="op">$</span><span class="va">fc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_linear.html">nn_linear</a></span><span class="op">(</span>in_features <span class="op">=</span> <span class="fl">512</span>, out_features <span class="op">=</span> <span class="fl">512</span><span class="op">)</span>
        <span class="va">self</span><span class="op">$</span><span class="va">fc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_linear.html">nn_linear</a></span><span class="op">(</span>in_features <span class="op">=</span> <span class="fl">512</span>, out_features <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
    <span class="op">}</span>,
  
    forward <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">embedding</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">lstm</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>, , <span class="op">]</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nnf_relu.html">nnf_relu</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">fc1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">dropout</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nnf_relu.html">nnf_relu</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">fc2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">dropout</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/nnf_relu.html">nnf_relu</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">fc3</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="模型训练" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83" class="anchor"></a>模型训练</h3>
<p>下一步我们将利用 GenomicNet 模版生成一个模型实例 <code>model</code>，然后对这个实例 <code>model</code> 进行训练以及验证。</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">GenomicNet</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>在开始训练模型之前，我们需要制定一些训练参数。由于这次的模型用于预测一个实数值，该模型可以归纳为回归分析。因此，在这里我们将采用最常用的均方误差 MSE 作为训练时的损失函数。另外，我们将采用 Adam 算法来优化模型。Adam 优化算法是很常用的算法之一并适用于大多是场合。</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">criterion</span> <span class="op">&lt;-</span> <span class="va">nnf_mse_loss</span>
<span class="va">optimizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/optim_adam.html">optim_adam</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></code></pre></div>
<p>接下来，我们将准备好的数据集和模型传送到 CPU 或 GPU 上开始进行模型训练。在这里，我们借助 <code>for</code> 循环使用同样的训练集反复训练模型 5 次（epoch）。在每次 epoch 训练中，我们将 <code>dataloader</code> 定义后的训练集赋予给模型进行训练。</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="op">)</span>

<span class="va">loss_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">epoch</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">loss_running</span> <span class="op">&lt;-</span> <span class="fl">0</span>
    <span class="va">n_train_samples</span> <span class="op">&lt;-</span> <span class="fl">0</span>

    <span class="co"># loop for minibatches</span>
    <span class="fu">coro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coro/man/collect.html">loop</a></span><span class="op">(</span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="va">dataloader_train</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">optimizer</span><span class="op">$</span><span class="fu">zero_grad</span><span class="op">(</span><span class="op">)</span>
        <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
        <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">criterion</span><span class="op">(</span><span class="va">output</span>, <span class="va">b</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
        <span class="va">loss</span><span class="op">$</span><span class="fu">backward</span><span class="op">(</span><span class="op">)</span>
        <span class="va">optimizer</span><span class="op">$</span><span class="fu">step</span><span class="op">(</span><span class="op">)</span>

        <span class="va">loss_running</span> <span class="op">&lt;-</span> <span class="va">loss_running</span> <span class="op">+</span> <span class="va">loss</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
        <span class="va">n_train_samples</span> <span class="op">&lt;-</span> <span class="va">n_train_samples</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>

    <span class="va">loss_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">loss_train</span>, <span class="va">loss_running</span> <span class="op">/</span> <span class="va">n_train_samples</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"epoch %d  loss: %3f\n"</span>, <span class="va">epoch</span>, <span class="va">loss_running</span> <span class="op">/</span> <span class="va">n_train_samples</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; epoch 1  loss: 0.081791</span>
<span class="co">#&gt; epoch 2  loss: 0.038323</span>
<span class="co">#&gt; epoch 3  loss: 0.034162</span>
<span class="co">#&gt; epoch 4  loss: 0.030365</span>
<span class="co">#&gt; epoch 5  loss: 0.026793</span></code></pre></div>
<p>我们可以看到随着迭代次数的增加，误差也在逐渐下降。我们还可以看到其误差在第 5 次训练之后的下降趋势依然没有减弱。因此，我们可以想象如果扩大训练次数可以进一步的降低损失。</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>epoch <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">loss_train</span><span class="op">)</span>, loss <span class="op">=</span> <span class="va">loss_train</span><span class="op">)</span> <span class="op"><a href="https://torch.mlverse.org/docs/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">epoch</span>, y <span class="op">=</span> <span class="va">loss</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="lstm_zh_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>让我们用同样的代码再次训练 5 次，然后再次确认损失的下降趋势。</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">epoch</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">loss_running</span> <span class="op">&lt;-</span> <span class="fl">0</span>
    <span class="va">n_train_samples</span> <span class="op">&lt;-</span> <span class="fl">0</span>

    <span class="fu">coro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coro/man/collect.html">loop</a></span><span class="op">(</span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="va">dataloader_train</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">optimizer</span><span class="op">$</span><span class="fu">zero_grad</span><span class="op">(</span><span class="op">)</span>
        <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
        <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">criterion</span><span class="op">(</span><span class="va">output</span>, <span class="va">b</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
        <span class="va">loss</span><span class="op">$</span><span class="fu">backward</span><span class="op">(</span><span class="op">)</span>
        <span class="va">optimizer</span><span class="op">$</span><span class="fu">step</span><span class="op">(</span><span class="op">)</span>

        <span class="va">loss_running</span> <span class="op">&lt;-</span> <span class="va">loss_running</span> <span class="op">+</span> <span class="va">loss</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
        <span class="va">n_train_samples</span> <span class="op">&lt;-</span> <span class="va">n_train_samples</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>

    <span class="va">loss_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">loss_train</span>, <span class="va">loss_running</span> <span class="op">/</span> <span class="va">n_train_samples</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"epoch %d  loss: %3f\n"</span>, <span class="va">epoch</span>, <span class="va">loss_running</span> <span class="op">/</span> <span class="va">n_train_samples</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; epoch 6  loss: 0.025920</span>
<span class="co">#&gt; epoch 7  loss: 0.023231</span>
<span class="co">#&gt; epoch 8  loss: 0.022283</span>
<span class="co">#&gt; epoch 9  loss: 0.021143</span>
<span class="co">#&gt; epoch 10  loss: 0.019768</span>


<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>epoch <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">loss_train</span><span class="op">)</span>, loss <span class="op">=</span> <span class="va">loss_train</span><span class="op">)</span> <span class="op"><a href="https://torch.mlverse.org/docs/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">epoch</span>, y <span class="op">=</span> <span class="va">loss</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="lstm_zh_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div id="模型评估" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0" class="anchor"></a>模型评估</h3>
<p>完成模型训练之后，我们将导入验证集来评估模型的性能。在这里，我们用与导入训练集同样的方法来读取验证集以及执行前期处理。</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">valid_fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'valid.tsv'</span>, package <span class="op">=</span> <span class="st">'Intro2DNN'</span><span class="op">)</span>
<span class="va">crisprcas9_valid_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">valid_fpath</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span>

<span class="va">x_valid</span> <span class="op">&lt;-</span> <span class="va">crisprcas9_valid_dataset</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">y_valid</span> <span class="op">&lt;-</span> <span class="va">crisprcas9_valid_dataset</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>

<span class="va">x_valid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">'ATCG'</span>, <span class="st">'1234'</span>, <span class="va">x_valid</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                  ncol <span class="op">=</span> <span class="fl">21</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">dataset_valid</span> <span class="op">&lt;-</span> <span class="fu">set_dataset</span><span class="op">(</span><span class="va">x_valid</span>, <span class="va">y_valid</span><span class="op">)</span>
<span class="va">dataloader_valid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/dataloader.html">dataloader</a></span><span class="op">(</span><span class="va">dataset_valid</span>, batch_size <span class="op">=</span> <span class="fl">1024</span>, shuffle <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>导入验证集之后，我们可以用与训练模型同样的方法来评估模型。在评估过程中，将模型的切换至评估模式可以提高计算速度。</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span><span class="op">$</span><span class="fu">eval</span><span class="op">(</span><span class="op">)</span>

<span class="va">y_true</span> <span class="op">&lt;-</span> <span class="va">y_valid</span>
<span class="va">y_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">loss_valid</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">n_valid_samples</span>  <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="fu">coro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coro/man/collect.html">loop</a></span><span class="op">(</span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="va">dataloader_valid</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
    <span class="va">y_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y_pred</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span>
    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">criterion</span><span class="op">(</span><span class="va">output</span>, <span class="va">b</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>

    <span class="va">loss_valid</span> <span class="op">&lt;-</span> <span class="va">loss_valid</span> <span class="op">+</span> <span class="va">loss</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
    <span class="va">n_valid_samples</span> <span class="op">&lt;-</span> <span class="va">n_valid_samples</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="va">loss_valid</span> <span class="op">&lt;-</span> <span class="va">loss_valid</span> <span class="op">/</span> <span class="va">n_valid_samples</span>
<span class="va">loss_valid</span>
<span class="co">#&gt; [1] 0.01609246</span></code></pre></div>
<p>当我们完成对验证集中的所有样本的验证预测之后，我们可绘制散点图来分析预测结果与真实的实验值的相关型。</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">y_true</span>, predicted <span class="op">=</span> <span class="va">y_pred</span><span class="op">)</span> <span class="op"><a href="https://torch.mlverse.org/docs/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">label</span>, y <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="lstm_zh_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>在上述的评估过程中，由验证集计算出的 MSE 会被赋予在 <code>loss_valid</code> 变量中。此外，我们还可以按照定义来计算 MSE 或斯皮尔曼等级相关系数等其它性能度量。</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MSE</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y_true</span> <span class="op">-</span> <span class="va">y_pred</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y_true</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.01609246</span>

<span class="co"># correlation</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">y_true</span>, <span class="va">y_pred</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'spearman'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.7825412</span></code></pre></div>
</div>
<div id="模型御用" class="section level3">
<h3 class="hasAnchor">
<a href="#%E6%A8%A1%E5%9E%8B%E5%BE%A1%E7%94%A8" class="anchor"></a>模型御用</h3>
<p>在本小节中，我们将介绍运用训练好的模型来预测 guide RNA 的切割效率。假如我们有一串 guide RNA 序列并且想预测其切割效率时，首先我们需要将其转换成整数，然后把整数转换成 tensor 型是之后代入模型即可。</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">'GAGTGATGATGGTCTGCACAC'</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">'ATCG'</span>, <span class="st">'1234'</span>, <span class="va">x</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                  ncol <span class="op">=</span> <span class="fl">21</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="co">#&gt; [1,]    4    1    4    2    4    1    2    4    1     2     4     4     2     3</span>
<span class="co">#&gt;      [,15] [,16] [,17] [,18] [,19] [,20] [,21]</span>
<span class="co">#&gt; [1,]     2     4     3     1     3     1     3</span>

<span class="va">x_tensor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html">torch_tensor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">x_tensor</span>
<span class="co">#&gt; torch_tensor</span>
<span class="co">#&gt;  4  1  4  2  4  1  2  4  1  2  4  4  2  3  2  4  3  1  3  1  3</span>
<span class="co">#&gt; [ CPULongType{1,21} ]</span>

<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">x_tensor</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span>
<span class="va">y</span>
<span class="co">#&gt; [1] 0.8684429</span></code></pre></div>
</div>
</div>
<div id="保存与读取模型" class="section level2">
<h2 class="hasAnchor">
<a href="#%E4%BF%9D%E5%AD%98%E4%B8%8E%E8%AF%BB%E5%8F%96%E6%A8%A1%E5%9E%8B" class="anchor"></a>保存与读取模型</h2>
<p>保存 torch 模型时需使用 <code>torch_save</code> 函数。使用 R 自带的 <code>save</code> 函数会将模型中不必要的变量也保存至文件中，而导致不能在其它计算机环境中再次利用该模型。</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_save.html">torch_save</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">'my_model.pth'</span><span class="op">)</span></code></pre></div>
<p>读取模型时使用 <code>torch_laod</code> 函数。由 <code>torch_load</code> 函数读取的模型可以再次用于预测或者再次训练。</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mymodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_load.html">torch_load</a></span><span class="op">(</span><span class="st">'my_model.pth'</span><span class="op">)</span>
<span class="va">mymodel</span><span class="op">$</span><span class="fu">eval</span><span class="op">(</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="st">'GAGTGATGATGGTCTGCACAC'</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">'ATCG'</span>, <span class="st">'1234'</span>, <span class="va">x</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                  ncol <span class="op">=</span> <span class="fl">21</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">x_tensor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html">torch_tensor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">x_tensor</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">mymodel</span><span class="op">(</span><span class="va">x_tensor</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>device <span class="op">=</span> <span class="st">'cpu'</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span>
<span class="va">y</span></code></pre></div>
</div>
<div id="系统环境" class="section level2">
<h2 class="hasAnchor">
<a href="#%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83" class="anchor"></a>系统环境</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ─ Session info  ──────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  hash: flag: United States, person facepalming: light skin tone, sandwich</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  setting  value</span>
<span class="co">#&gt;  version  R Under development (unstable) (2021-10-28 r81109)</span>
<span class="co">#&gt;  os       Ubuntu 20.04.3 LTS</span>
<span class="co">#&gt;  system   x86_64, linux-gnu</span>
<span class="co">#&gt;  ui       X11</span>
<span class="co">#&gt;  language (EN)</span>
<span class="co">#&gt;  collate  en_US.UTF-8</span>
<span class="co">#&gt;  ctype    en_US.UTF-8</span>
<span class="co">#&gt;  tz       Etc/UTC</span>
<span class="co">#&gt;  date     2021-10-31</span>
<span class="co">#&gt;  pandoc   2.14.0.3 @ /usr/local/bin/ (via rmarkdown)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ─ Packages ───────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  package     * version date (UTC) lib source</span>
<span class="co">#&gt;  assertthat    0.2.1   2019-03-21 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  backports     1.3.0   2021-10-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  bit           4.0.4   2020-08-04 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  bit64         4.0.5   2020-08-30 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  broom         0.7.9   2021-07-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  cachem        1.0.6   2021-08-19 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  callr         3.7.0   2021-04-20 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  cellranger    1.1.0   2016-07-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  cli           3.1.0   2021-10-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  colorspace    2.0-2   2021-06-24 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  coro        * 1.0.1   2020-12-17 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  crayon        1.4.2   2021-10-29 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  DBI           1.1.1   2021-01-15 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  dbplyr        2.1.1   2021-04-06 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  desc          1.4.0   2021-09-28 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  devtools      2.4.2   2021-06-07 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  digest        0.6.28  2021-09-23 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  dplyr       * 1.0.7   2021-06-18 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  ellipsis      0.3.2   2021-04-29 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  evaluate      0.14    2019-05-28 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  fansi         0.5.0   2021-05-25 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  farver        2.1.0   2021-02-28 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  fastmap       1.1.0   2021-01-25 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  forcats     * 0.5.1   2021-01-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  fs            1.5.0   2020-07-31 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  generics      0.1.1   2021-10-25 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  ggplot2     * 3.3.5   2021-06-25 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  glue          1.4.2   2020-08-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  gtable        0.3.0   2019-03-25 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  haven         2.4.3   2021-08-04 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  highr         0.9     2021-04-16 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  hms           1.1.1   2021-09-26 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  htmltools     0.5.2   2021-08-25 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  httr          1.4.2   2020-07-20 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  jsonlite      1.7.2   2020-12-09 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  knitr         1.36    2021-09-29 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  labeling      0.4.2   2020-10-20 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  lifecycle     1.0.1   2021-09-24 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  lubridate     1.8.0   2021-10-07 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  magrittr      2.0.1   2020-11-17 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  memoise       2.0.0   2021-01-26 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  modelr        0.1.8   2020-05-19 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  munsell       0.5.0   2018-06-12 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  pillar        1.6.4   2021-10-18 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  pkgbuild      1.2.0   2020-12-15 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  pkgconfig     2.0.3   2019-09-22 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  pkgdown       1.6.1   2020-09-12 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  pkgload       1.2.3   2021-10-13 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  prettyunits   1.1.1   2020-01-24 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  processx      3.5.2   2021-04-30 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  ps            1.6.0   2021-02-28 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  purrr       * 0.3.4   2020-04-17 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  R6            2.5.1   2021-08-19 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  ragg          1.2.0   2021-10-30 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  Rcpp          1.0.7   2021-07-07 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  readr       * 2.0.2   2021-09-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  readxl        1.3.1   2019-03-13 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  remotes       2.4.1   2021-09-29 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  reprex        2.0.1   2021-08-05 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  rlang         0.4.12  2021-10-18 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  rmarkdown     2.11    2021-09-14 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  rprojroot     2.0.2   2020-11-15 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  rstudioapi    0.13    2020-11-12 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  rvest         1.0.2   2021-10-16 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  scales        1.1.1   2020-05-11 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  sessioninfo   1.2.0   2021-10-31 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  stringi       1.7.5   2021-10-04 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  stringr     * 1.4.0   2019-02-10 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  systemfonts   1.0.3   2021-10-13 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  testthat      3.1.0   2021-10-04 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  textshaping   0.3.6   2021-10-13 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  tibble      * 3.1.5   2021-09-30 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  tidyr       * 1.1.4   2021-09-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  tidyselect    1.1.1   2021-04-30 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  tidyverse   * 1.3.1   2021-04-15 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  torch       * 0.6.0   2021-10-07 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  tzdb          0.2.0   2021-10-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  usethis       2.1.3   2021-10-27 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  utf8          1.2.2   2021-07-24 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  vctrs         0.3.8   2021-04-29 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  withr         2.4.2   2021-04-18 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  xfun          0.27    2021-10-18 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  xml2          1.3.2   2020-04-23 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt;  yaml          2.2.1   2020-02-01 [2] CRAN (R 4.2.0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [1] /tmp/RtmpvfiGT9/temp_libpath2a344ca05124</span>
<span class="co">#&gt;  [2] /usr/local/lib/R/site-library</span>
<span class="co">#&gt;  [3] /usr/local/lib/R/library</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ──────────────────────────────────────────────────────────────────────────────</span></code></pre></div>
</div>
<div id="参考文献" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" class="anchor"></a>参考文献</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-coro" class="csl-entry">
Henry, Lionel. 2021. <span>“Coro: ’Coroutines’ for r.”</span> <a href="ttps://cran.r-project.org/package=coro">ttps://cran.r-project.org/package=coro</a>.
</div>
<div id="ref-torch4r" class="csl-entry">
PBC, RStudio. 2021. <span>“Torch for r.”</span> <a href="https://torch.mlverse.org/">https://torch.mlverse.org/</a>.
</div>
<div id="ref-Wang_2019" class="csl-entry">
Wang D, Wang B, Zhang C. 2019. <span>“Optimized CRISPR Guide RNA Design for Two High-Fidelity Cas9 Variants by Deep Learning.”</span> <em>Nat Commun</em> 10(1): 4284. <a href="https://doi.org/10.1038/s41467-019-12281-8">https://doi.org/10.1038/s41467-019-12281-8</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jianqiang Sun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
